# ネットワークデバイス強化

https://tryhackme.com/room/networkdevicehardening

ネットワーク上のエンドポイントデバイスではなく、ネットワークリソースを制御および管理するために使用されるデバイスをネットワークデバイスと呼ぶ。ルーター、スイッチ、ロードバランサ、VPN、IDS など。

## 一般的なテクニック

- セキュリティパッチ
- 不要なポート、サービス無効
- 最小権限の原則
- ログ監視
- 定期的バックアップ
- 強力なパスワード
- 多要素認証
- 安全なプロトコル

## VPN の強化

### 強力な暗号アルゴリズム、認証

ただし、暗号と認証はパケットごとに処理されるため、強力さと処理負荷のバランスが重要。

/etc/openvpn/server/server.conf

```shell
# 暗号アルゴリズム
cipher AES-256-CBC

# 認証
auth SHA256
```

### ゲートウェイソフトウェアを最新に保つ

```shell
sudo apt upgrade openvpn
```

### デフォルトユーザー名、パスワードを変更

openvpn 自体にはデフォルトは無いが、GUI ツールなどでデフォルトが作られる場合の話

### Perfect Forward Secrecy (PFS) を有効にする

```shell
# キーの生成
sudo openvpn --genkey --secret my.key
```

/etc/openvpn/server/server.conf

```shell
# PFS 有効化
tls-crypt my.key
```

### VPN サーバー専用ユーザー

OpenVPN サーバーの実行専用のユーザー、グループを作り、アクセスを制限する。

## ルーター、スイッチ、FW の強化

### 一般的なテクニック

#### デバイスの設定

ネットワーク デバイスを設定する際には、ホスト名、タイムゾーン、ログ記録などの関連する詳細をすべて入力する

#### デフォルトの資格情報を変更

Web 管理インターフェースの認証情報

#### セキュアプロトコルを有効化

#### 不要なスクリプト無効化

#### デフォルトの資格情報を変更

- WPA2/WPA3 などの強力な暗号化を有効
- SSID ブロードキャストを無効
- デフォルトのパスワードを変更

### その他

- トラフィック ルールの管理
- トラフィックの監視
- ポート転送の設定
- スケジュールされたタスクの監視
- ファームウェアの更新

### エンタープライズ環境

#### ポート セキュリティの設定

スイッチ ポートに登録される MAC アドレスの数を制限し、不正アクセスが検出されたときに特定のアクションを実行する

#### ARP スプーフィングの防止

静的 ARP テーブルを有効にし、MAC アドレス フィルタリングを実装する

#### 不正な DHCP サーバーの防止

静的 DHCP バインディングを構成、ネットワークマッピング ツールを使用して不明なデバイスがネットワークに追加されないようにするなど

#### IPv6 の有効化

IPv6 には IPsec のサポートが組み込まれており、ネットワーク通信を保護し、機密性、整合性、信頼性を確保するために使用できる

## ネットワーク監視ツール

| Tool                                   | Usage Description                                                                                                                                                                        |
| -------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Nagios                                 | システム、ネットワーク、インフラを監視する人気のオープンソースソフトウェア。リアルタイム監視とアラート機能を提供。                                                                       |
| SolarWinds Network Performance Monitor | ネットワークパフォーマンスと可用性をリアルタイムで可視化する包括的なネットワーク監視ツール。ネットワークマッピング、自動ネットワーク検出、カスタマイズ可能なダッシュボードを備える。     |
| PRTG                                   | ネットワークのパフォーマンスと可用性を総合的に監視するオールインワンのツール。リアルタイムのトラフィック分析、カスタムダッシュボード、カスタマイズ可能なアラート機能を提供。             |
| Zabbix                                 | 強力なオープンソースのネットワーク監視ツール。リアルタイムのネットワークパフォーマンスと可用性を監視し、カスタマイズ可能なダッシュボード、ネットワークマッピング、アラート機能を備える。 |

https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/4/en/quickstart.html

https://documentation.solarwinds.com/en/success_center/npm/content/npm_installation_guide.htm

https://www.paessler.com/manuals/prtg/installation

https://www.zabbix.com/download
