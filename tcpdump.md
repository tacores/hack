# tcpdump

https://tryhackme.com/room/tcpdump

## オプション

| コマンド例             | 説明                                                         |
| ---------------------- | ------------------------------------------------------------ |
| `tcpdump -i INTERFACE` | 特定のネットワークインターフェースでパケットをキャプチャする |
| `tcpdump -w FILE`      | キャプチャしたパケットをファイルに保存する                   |
| `tcpdump -r FILE`      | 保存されたパケットファイルを読み込む                         |
| `tcpdump -c COUNT`     | 指定した数のパケットだけをキャプチャする                     |
| `tcpdump -n`           | IP アドレスの名前解決を行わない                              |
| `tcpdump -nn`          | IP アドレスとプロトコル番号の名前解決を行わない              |
| `tcpdump -v`           | 詳細表示（`-vv`, `-vvv` を使うとさらに詳細に）               |

## フィルタリング

| コマンド例                                       | 説明                                                       |
| ------------------------------------------------ | ---------------------------------------------------------- |
| `tcpdump host IP` または `tcpdump host HOSTNAME` | 指定した IP アドレスまたはホスト名のパケットをフィルタする |
| `tcpdump src host IP`                            | 指定した送信元ホストのパケットのみをフィルタする           |
| `tcpdump dst host IP`                            | 指定した宛先ホストのパケットのみをフィルタする             |
| `tcpdump port PORT_NUMBER`                       | 指定したポート番号のパケットをフィルタする                 |
| `tcpdump src port PORT_NUMBER`                   | 指定した送信元ポート番号のパケットをフィルタする           |
| `tcpdump dst port PORT_NUMBER`                   | 指定した宛先ポート番号のパケットをフィルタする             |
| `tcpdump PROTOCOL`                               | プロトコルでフィルタする（例：`ip`, `ip6`, `icmp` など）   |

その他の高度なフィルターは、下記をチェック。

```sh
man pcap-filter
```

## パケット表示オプション

| コマンド例    | 説明                                                 |
| ------------- | ---------------------------------------------------- |
| `tcpdump -q`  | 素早く静かに：簡潔なパケット情報を表示する           |
| `tcpdump -e`  | イーサネットの MAC アドレス情報を表示する            |
| `tcpdump -A`  | パケット内容を ASCII エンコードで表示する            |
| `tcpdump -xx` | パケット内容を 16 進形式（ヘッダとデータ）で表示する |
| `tcpdump -X`  | パケット内容を 16 進数と ASCII の両方で表示する      |
