# ステガノグラフィー

CTF でよく使われるので、セキュリティを学習するためには必要。  
困ったらここ  
https://georgeom.net/StegOnline/checklist

## 画像

### steghide

```shell
# 画像などに隠された情報を展開する。パスワードを聞かれる
steghide --extract -sf ./sample.jpg

# パスワードクラック。指定しなければ rockyou.txt が使われる
stegcracker ./sample.jpg

# stegseek は桁違いに速い。原理は要調査。
stegseek ./sample.jpg /usr/share/wordlists/rockyou.txt
stegseek --seed ./sample.jpg
```

### outguess

```sh
outguess -r ./sample.jpg ./out.txt
```

### file

```shell
file <filename>

king: JPEG image data, Exif standard: [TIFF image data, big-endian, direntries=14, height=4000, bps=0, PhotometricInterpretation=RGB, description=Viking ships on the water under the sunlight and dark storm. Invasion in the storm. 3D illustration.; Shutterstock ID 100901071, orientation=upper-left, width=6000], baseline, precision 8, 1600x1067, components 3
```

### 文字列

```shell
strings -n 7 -t x <filename>
```

```shell
# 含まれてる文字列でクラックしてみる
strings -n 7 <filename> > img_string.txt
stegcracker ./sample.jpg ./img_string.txt
```

### Mnemonic

https://github.com/MustafaTanguner/Mnemonic

### ゼロ幅文字テキストステガノグラフィ

https://330k.github.io/misc_tools/unicode_steganography.html

### binwalk

ファイルが内包されていないか確認する。

```shell
binwalk -Me <filename>
```

### pdf

```shell
pdfinfo <filename>
```

## 音声

https://www.sonicvisualiser.org/download.html

Layerの「Add Spectrogram」

## piet

幾何学的な画像ファイルをプログラムとして実行する

### npiet online

https://www.bertnase.de/npiet/npiet-execute.php


エラーが出たらこれで変換を試す価値はある。

```python
from PIL import Image
img = Image.open("credentials.png").convert("RGB")
img.save("credentials_true.png")
```

### repiet

https://github.com/boothby/repiet

--codel_size を入れると成功する場合もある。

```sh
repiet --codel_size 10 -x -o out.txt ./credentials.png
```

## 文字列

`H4sIAAA...` は、gzip をBase64エンコードしたときにあらわれる文字列。
