# モバイルマルウェア分析

https://beta.pithus.org/

https://github.com/MobSF/Mobile-Security-Framework-MobSF

## apkデコンパイル

apkを取得

```sh
# apkのPathを取得
adb shell pm path com.shortstack.hackertracker

# apkを取得
adb pull /data/app/com.shortstack.hackertracker-1/base.apk
```

### jadx

https://github.com/skylot/jadx

apkをsmaliにデコンパイルし、Javaに再変換

```sh
jadx -d [path-output-folder] [path-apk-or-dex-file]
```

GUIバージョン

```sh
jadx\bin\jadx-gui
```

### dex2jar

https://sourceforge.net/projects/dex2jar/

jarに変換。[JD-GUI](https://java-decompiler.github.io/)で開ける

```sh
d2j-dex2jar.sh (or .bat) /path/application.apk
```

### apktool

https://github.com/iBotPeaches/Apktool

smali形式のソースコードを取得

```sh
apktool d file.apk
```

## 静的解析

弱い暗号

```sh
grep -r "SecretKeySpec" *
grep -rli " aes " *
grep -rli "iv"
```

アクティビティ

```sh
cat AndroidManifest.xml | grep "activity" --color
```

バックアップ有効

```sh
cat AndroidManifest.xml | grep "android:allowBackup" --color
```

デバッグ可能

```sh
cat AndroidManifest.xml | grep "android:debuggable" --color
```

